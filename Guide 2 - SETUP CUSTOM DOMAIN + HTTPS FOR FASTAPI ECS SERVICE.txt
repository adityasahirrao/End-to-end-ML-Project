âœ… SETUP CUSTOM DOMAIN + HTTPS FOR FASTAPI ECS SERVICE (ACM + Route 53 + ALB)

ğŸ“Œ Prerequisites:
-----------------------
- You already deployed the ECS service (Fargate) with a public IP or using Load Balancer
- You have a domain purchased and managed in **Route 53**
- You want HTTPS support using **SSL (ACM certificate)**

1ï¸. Create SSL Certificate in ACM
---------------------------------------
- Go to AWS Console â†’ **ACM (Certificate Manager)** â†’ Request a certificate
- Type: Public Certificate
- Add domain name: `yourdomain.com` and optionally `www.yourdomain.com`
- Select DNS validation â†’ Next â†’ Confirm & Request
- Click the domain row â†’ Expand â†’ Copy CNAME values
- Go to **Route 53 â†’ Hosted Zones â†’ yourdomain.com â†’ Create record**
  - Type: CNAME
  - Paste the copied values
- Wait a few minutes â†’ ACM Status will show âœ… **Issued**

2ï¸. Create an Application Load Balancer (ALB)
---------------------------------------
- Go to **EC2 â†’ Load Balancers â†’ Create Load Balancer**
- Type: **Application Load Balancer**
- Name: `house-price-prediction-alb`
- Scheme: internet-facing
- IP type: IPv4
- Listeners: HTTP (80), add HTTPS (443)
- VPC: Choose same as ECS Cluster
- Availability Zones: Pick at least 2 subnets
- Click Next: Security Groups â†’ allow ports 80 and 443
- Click Next: Target Group
  - Name: `ecs-target-group`
  - Target type: IP
  - Protocol: HTTP
  - Port: 80
- Register targets: Skip for now (will auto-link later)
- Create Load Balancer

3ï¸. Attach HTTPS Listener with ACM Cert
---------------------------------------
- Go to Load Balancer > Listeners tab > HTTPS (443) â†’ View/Edit rules
- Add rule to forward all traffic to your target group
- Attach your ACM certificate to HTTPS listener

4ï¸. Update ECS Service to use ALB
---------------------------------------
- Go to ECS â†’ Clusters â†’ your cluster â†’ Services â†’ house-price-prediction-service
- Click Update â†’ Edit Load Balancing
  - Load Balancer Type: Application Load Balancer
  - Select your ALB and listener (port 80 or 443)
  - Choose existing target group (ecs-target-group)
- Update the service â†’ It will re-deploy tasks and register targets

5ï¸. Point Domain to Load Balancer
---------------------------------------
- Go to **Route 53 â†’ Hosted Zones â†’ yourdomain.com**
- Create new Record:
  - Type: A (Alias)
  - Alias to: Application Load Balancer
  - Choose your ALB DNS name
- Save the record

6ï¸. Test Domain + HTTPS
---------------------------------------
- Open https://yourdomain.com â†’ âœ… FastAPI app secured with SSL!
- You can now hide the public IP and access only via domain

ğŸ“Œ Extra Optional Tips:
---------------------------------------
- Add automatic HTTP to HTTPS redirect in listener rules
- Add `/health` check endpoint in FastAPI for Load Balancer health check
- Enable CloudWatch logs for Load Balancer to monitor requests

âœ… You now have:
---------------------------------------
âœ”ï¸ FastAPI app on ECS Fargate  
âœ”ï¸ GitHub CI/CD deploying via Actions  
âœ”ï¸ HTTPS secured via ACM  
âœ”ï¸ Domain pointed via Route 53  
